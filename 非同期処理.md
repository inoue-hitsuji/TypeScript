## 非同期処理

**時間のかかる処理は非同期処理とするのがよい**。「時間のかかる処理」というのは例えば

- 通信
- ファイルアクセス

などである。非同期処理を行う API には

- ブロッキング：処理が完了するまで待つ
- **ノンブロッキング**：処理を開始してすぐに返る

があるが、TypeScript はシングルスレッドなので、ノンブロッキングを選ぶことが多い。

ノンブロッキングな関数は、**非同期処理の終了を検知する手段**として
**コールバック関数**を必要とする。

例：`readFile(path, (err, data) => { ... })`
この場合、ファイル読み込みが完了したらコールバック関数が呼ばれる。

## Promise による抽象化

ノンブロッキングな関数の引数ではなく、その返り値として **Promise** オブジェクトを返し、
それにコールバック関数を登録することもできる。

Promise には、非同期処理の成功時と失敗時に呼ばれるコールバック関数をそれぞれ登録する。

例：`readFile(path).then(data => { ... }).catch(err => { ... })`
`then` で成功時の処理、`catch` で失敗時の処理を登録する。

## async/await

async 関数および await 式は **Promise を同期処理のように書く**ための糖衣構文である。

- async 関数は Promise を返す
- await は式に設定した Promise の解決（または拒否）を待つ。

例：
```typescript
async function example() {
  try {
    const data = await readFile(path);
    // 成功時の処理
  } catch (err) {
    // 失敗時の処理
  }
}
```

## 備考

同期的に実行中のプログラムに非同期が**割り込むことはない**。